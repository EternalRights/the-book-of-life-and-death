<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¥¿æ¸¸ç”Ÿæ­»ç°¿</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="../js/axios.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ä¸­æ–‡ä¹¦æ³•å­—ä½“ */
        html[lang="zh-CN"] * {
            font-family: 'Ma Shan Zheng', 
                        "PingFang SC", "Hiragino Sans GB", 
                        "Microsoft YaHei", sans-serif;
        }

        /* è‹±æ–‡æ— è¡¬çº¿å­—ä½“ */
        html:not([lang="zh-CN"]) * {
            font-family: 'Segoe UI', Tahoma,
                        Arial, "Helvetica Neue",
                        sans-serif;
        }

        /* ç‰¹æ®Šå…ƒç´ ä¿æŒé€šç”¨å­—ä½“ */
        .current-time, button, input {
            font-family: inherit !important;
        }

        body {
            background: linear-gradient(to bottom, #1a0a2e, #0d0630, #060318);
            color: #e6d3a7;
            min-height: 10vh;
            overflow-x: hidden;
            overflow-y: auto;
            /* overflow: hidden; */
            position: relative;
        }

        /* åœ°ç‹±ç«ç„°èƒŒæ™¯æ•ˆæœ */
        .hellfire {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30%;
            background: linear-gradient(to top, rgba(139,0,0,0.7), transparent);
            z-index: -1;
        }
        
        .hellfire::after {
            content: '';
            position: absolute;
            bottom: -30px;
            width: 100%;
            height: 100px;
            background: radial-gradient(ellipse at center, rgba(255, 69, 0, 0.8) 0%, rgba(178, 34, 34, 0.6) 30%, rgba(139, 0, 0, 0) 70%);
            animation: fire 3s infinite alternate;
        }
        
        @keyframes fire {
            0% { transform: translateY(0) scale(1.05); }
            100% { transform: translateY(10px) scale(1); }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            min-height: 100vh;
            position: relative;
            z-index: 2;
        }
        
        .time-controller {
            flex: 0 0 320px;
            background: rgba(25, 15, 45, 0.7);
            border-radius: 12px;
            padding: 25px;
            margin-right: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 2px solid #704214;
            position: relative;
            overflow: hidden;
        }
        
        .time-controller::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(to right, #daa520, #ff8c00, #daa520);
            box-shadow: 0 0 15px #ff8c00;
        }
        
        .book-section {
            flex: 1;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%231d1529" /><path d="M0,0 L50,0 L30,100 L0,100 Z" fill="%23301c4d" opacity="0.6" /><path d="M50,0 L100,0 L100,100 L30,100 Z" fill="%23301c4d" opacity="0.6" /></svg>'),
                        linear-gradient(to bottom, #261b35, #180f29);
            background-size: 100px 100px, cover;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.7);
            padding: 30px;
            position: relative;
            border: 1px solid #704214;
            display: flex;
            flex-direction: column;
        }
        
        .title-header {
            text-align: center;
            margin-bottom: 20px;
            position: relative;
        }
        
        .title-header h1 {
            font-size: 3.5rem;
            color: #ffcc66;
            text-shadow: 0 0 15px rgba(255, 102, 0, 0.8);
            letter-spacing: 8px;
            margin: 10px 0;
            position: relative;
            background: linear-gradient(to bottom, #ffcc66, #ff9900);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .title-header h1::after {
            content: '';
            display: block;
            width: 80%;
            height: 3px;
            background: linear-gradient(to right, transparent, #daa520, transparent);
            margin: 15px auto 0;
        }
        
        .title-header h2 {
            font-size: 1.5rem;
            color: #cc9966;
            font-weight: normal;
            margin-top: 10px;
        }
        
        /* æ—¶é—´æ˜¾ç¤ºè®¾è®¡ */
        .time-display {
            text-align: center;
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #704214;
        }
        
        .current-time {
            font-size: 4rem;
            font-weight: bold;
            color: #ff9900;
            text-shadow: 0 0 20px rgba(255, 69, 0, 0.8);
            margin: 15px 0;
            letter-spacing: 3px;
            background: linear-gradient(to bottom, #ffcc66, #ff9900);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .year-range {
            display: flex;
            justify-content: space-between;
            font-size: 1.2rem;
            color: #cc9966;
            margin-top: 10px;
        }
        
        /* æ—¶é—´æ§åˆ¶æŒ‰é’® */
        .time-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }
        
        button {
            background: linear-gradient(to bottom, #3d2a1a, #261808);
            color: #e6d3a7;
            border: 2px solid #704214;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-family: inherit;
            transition: all 0.3s ease;
            outline: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        button:hover {
            background: linear-gradient(to bottom, #4e3a2b, #352411);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.5);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        .custom-time {
            margin-top: 25px;
        }
        
        .custom-time h3 {
            color: #daa520;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.4rem;
        }
        
        .time-input {
            display: flex;
            gap: 10px;
        }
        
        input[type="number"] {
            flex: 1;
            background: rgba(25, 15, 45, 0.7);
            border: 2px solid #704214;
            color: #ffcc66;
            padding: 12px;
            border-radius: 8px;
            font-size: 1.2rem;
            outline: none;
        }
        
        input[type="number"]:focus {
            border-color: #daa520;
            box-shadow: 0 0 10px rgba(218, 165, 32, 0.5);
        }
        
        /* è¯­è¨€åˆ‡æ¢ */
        .language-switch {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
        }
        
        .music-control {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .search-container {
            margin-bottom: 25px;
            display: flex;
            gap: 10px;
        }
        
        .search-container input {
            flex: 1;
            padding: 12px 20px;
            border-radius: 8px;
            background: rgba(25, 15, 45, 0.7);
            border: 2px solid #704214;
            color: #e6d3a7;
            font-size: 1.2rem;
        }
        
        /* è§’è‰²å¡ç‰‡è®¾è®¡ */
        .character-card {
            background: linear-gradient(to bottom right, rgba(40, 25, 65, 0.9), rgba(30, 15, 45, 0.9));
            border: 3px solid #704214;
            border-radius: 12px;
            padding: 25px;
            min-height: 500px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.6);
        }
        
        .character-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M0,0 L30,30 L0,60 Z" fill="%23301c4d" opacity="0.1"/><path d="M100,100 L70,70 L100,40 Z" fill="%23301c4d" opacity="0.1"/></svg>');
            opacity: 0.3;
            z-index: 0;
        }
        
        .character-content {
            position: relative;
            z-index: 2;
            display: grid;
            grid-template-columns: 1fr 2fr;
            grid-gap: 25px;
            height: 100%;
        }
        
        .character-image {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .character-image div {
        width: 200px;
        height: 200px;
        border-radius: 50%;
        border: 5px solid #704214;
        background: linear-gradient(45deg, #2a1d41, #452e6a);
        box-shadow: 0 0 30px rgba(112, 66, 20, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 7rem;
        overflow: hidden;
        }
        
        .character-image img {
        width: 100%;
        height: 100%;
        object-fit: cover; /* ä¿æŒæ¯”ä¾‹è£å‰ª */
        border-radius: 50%; /* åœ†å½¢è£å‰ª */
        border: 2px solid #daa520; /* é‡‘è‰²è¾¹æ¡† */
        box-shadow: 0 0 20px rgba(218, 165, 32, 0.5); /* å‘å…‰æ•ˆæœ */
        }
        
        .character-details {
            padding: 15px;
        }
        
        .character-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #704214;
            padding-bottom: 15px;
        }
        
        .character-name {
            font-size: 2.8rem;
            color: #ffcc66;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255, 102, 0, 0.7);
        }
        
        .status-indicator {
            font-size: 1.5rem;
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .status-alive {
            background: rgba(0, 100, 0, 0.4);
            color: #90ee90;
            border: 2px solid #228b22;
        }
        
        .status-dead {
            background: rgba(139, 0, 0, 0.4);
            color: #ff9999;
            border: 2px solid #8b0000;
        }
        
        .attribute-row {
            display: flex;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px dashed #704214;
        }
        
        .attribute-label {
            flex: 0 0 140px;
            color: #daa520;
            font-size: 1.3rem;
        }
        
        .attribute-value {
            flex: 1;
            font-size: 1.3rem;
            color: #e6d3a7;
            text-shadow: 0 0 5px rgba(255, 204, 102, 0.3);
        }
        
        .cause-red {
            color: #ff6666;
            text-shadow: 0 0 8px rgba(255, 102, 102, 0.5);
            font-weight: bold;
        }
        
        .character-bio {
            margin-top: 25px;
            padding: 15px;
            background: rgba(20, 10, 30, 0.6);
            border-radius: 8px;
            border: 1px solid #704214;
            font-size: 1.2rem;
            line-height: 1.6;
            text-align: justify;
        }
        
        /* åˆ†é¡µå’Œä¹¦ç±æ•ˆæœ */
        .book-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #704214;
        }
        
        .page-indicator {
            font-size: 1.3rem;
            color: #cc9966;
        }
        
        .page-controls {
            display: flex;
            gap: 15px;
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(255, 165, 0, 0.7); }
            50% { box-shadow: 0 0 20px rgba(255, 69, 0, 0.9); }
            100% { box-shadow: 0 0 5px rgba(255, 165, 0, 0.7); }
        }
        
        .glowing {
            animation: glow 2s infinite ease-in-out;
        }
        
        .flip-enter-active, .flip-leave-active {
            transition: all 0.7s ease;
        }
        
        .flip-enter-from, .flip-leave-to {
            opacity: 0;
            transform: rotateY(90deg);
        }
        
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.5s ease;
        }
        
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
        
        .status-change {
            animation: statusChange 1s ease-in-out;
        }
        
        @keyframes statusChange {
            0% { transform: scale(1); text-shadow: 0 0 10px currentColor; }
            50% { transform: scale(1.2); text-shadow: 0 0 25px currentColor; }
            100% { transform: scale(1); text-shadow: 0 0 10px currentColor; }
        }
    </style>
</head>

<body>
    <div id="app">
        <!-- åœ°ç‹±ç«ç„°èƒŒæ™¯æ•ˆæœ -->
        <div class="hellfire"></div>
        
        <!-- éŸ³ä¹æ§åˆ¶ -->
        <div class="music-control">
            <button @click="toggleMusic">{{ language === 'zh' ? (musicPlaying ? 'åœæ­¢éŸ³ä¹' : 'æ’­æ”¾éŸ³ä¹') : (musicPlaying ? 'Stop Music' : 'Play Music') }}</button>
        </div>
        
        <!-- è¯­è¨€åˆ‡æ¢ -->
        <div class="language-switch">
            <button @click="toggleLanguage">{{ language === 'zh' ? 'ä¸­æ–‡/English' : 'English/ä¸­æ–‡' }}</button>
        </div>
        
        <div class="container">
            <!-- æ—¶é—´æ§åˆ¶å™¨ -->
            <div class="time-controller">
                <!-- è™šæ‹Ÿæ—¶é—´çº¿ -->
                <div class="time-display">
                    <h3>{{ language === 'zh' ? 'è™šæ‹Ÿæ—¶é—´çº¿' : 'Virtual Timeline' }}</h3>
                    <div class="current-time glowing">
                        {{ currentYear }} {{ language === 'zh' ? 'å¹´' : 'year' }}
                    </div>
                    <div class="year-range">
                        <span>0 {{ language === 'zh' ? 'å¹´' : '' }}</span>
                        <span>2027 {{ language === 'zh' ? 'å¹´' : '' }}</span>
                    </div>
                </div>
                
                <!-- æ—¶é—´æ§åˆ¶ -->
                <div class="time-controls">
                    <button @click="toggleTimer">{{ timerRunning ? (language === 'zh' ? 'æš‚åœæ—¶é—´' : 'Pause') : (language === 'zh' ? 'å¼€å§‹æ—¶é—´' : 'Start') }}</button>
                    <button @click="resetTimer">{{ language === 'zh' ? 'é‡ç½®æ—¶é—´' : 'Reset' }}</button>
                </div>
                
                <!-- è‡ªå®šä¹‰æ—¶é—´ -->
                <div class="custom-time">
                    <h3>{{ language === 'zh' ? 'æ—¶é—´ç©¿æ¢­' : 'Time Travel' }}</h3>
                    <div class="time-input">
                        <input type="number" v-model="customYear" min="0" max="2027">
                        <button @click="jumpToYear">{{ language === 'zh' ? 'è·³è½¬' : 'Go' }}</button>
                    </div>
                </div>
                
                <!-- è§’è‰²çŠ¶æ€è®°å½• -->
                <div class="status-change-info">
                    <h3>{{ language === 'zh' ? 'çŠ¶æ€å˜æ›´è®°å½•' : 'State Change Record' }}</h3>
                    <div v-for="(change, index) in statusChanges" :key="index" class="status-change-item">
                        {{ change }}
                    </div>
                    <div v-if="statusChanges.length === 0" class="no-change">
                        {{ language === 'zh' ? 'æš‚æ— å˜æ›´' : 'No recent changes' }}
                    </div>
                </div>
            </div>  
            
            <!-- ä¹¦ -->
            <div class="book-section">
                
                <div class="title-header">
                    <h1>{{ language === 'zh' ? 'è¥¿æ¸¸ç”Ÿæ­»ç°¿' : 'Journey to the West\'s Book of Life and Death'}}</h1>
                    <h2>{{ language === 'zh' ? 'è®°å½•å¤©åœ°äººç¥å¦–çš„ç”Ÿæ­»å‘½è¿' : 'Chronicle of Life and Death in Journey to the West' }}</h2>
                </div>
                
                <div class="search-container">
                    <input type="text" v-model="searchQuery" :placeholder="language === 'zh' ? 'æœç´¢è§’è‰²åç§°...' : 'Search character...'">
                    <button @click="searchQuery = ''">{{ language === 'zh' ? 'æ¸…ç©º' : 'Clear' }}</button>
                </div>
                
                    <transition name="flip" mode="out-in">
                    <div v-if="filteredCharacters.length" class="character-card" :key="currentCharacterIndex">
                        <div class="character-content">
                            <div class="character-image">
                                <img v-bind:src="getEmoji(currentCharacter.name)">
                            </div>
                            <div class="character-details">
                                <div class="character-header">
                                    <div class="character-name">{{ getLocalizedProp(currentCharacter, 'name') }}</div>
                                    <div class="status-indicator" :class="getStatusClass(currentCharacter)" :key="statusKey">
                                        {{ getStatusText(currentCharacter) }}
                                    </div>
                                </div>
                                
                                <div class="attribute-row">
                                    <div class="attribute-label">{{ language === 'zh' ? 'ä»å±ç±»åˆ«:' : 'Affiliation:' }}</div>
                                    <div class="attribute-value">
                                        {{ getLocalizedProp(currentCharacter, 'affiliation') }}
                                    </div>
                                </div>
                                
                                <div class="attribute-row">
                                    <div class="attribute-label">{{ language === 'zh' ? 'å‡ºç”Ÿæ—¶é—´:' : 'Birth Year:' }}</div>
                                    <div class="attribute-value">{{ currentCharacter.birthYear }} {{ language === 'zh' ? 'å¹´' : '' }}</div>
                                </div>
                                
                                <div class="attribute-row" v-if="isDead(currentCharacter)">
                                    <div class="attribute-label">{{ language === 'zh' ? 'æ­»äº¡æ—¶é—´:' : 'Death Year:' }}</div>
                                    <div class="attribute-value">{{ currentCharacter.deathYear }} {{ language === 'zh' ? 'å¹´' : '' }}</div>
                                </div>
                                
                                <div class="attribute-row" v-if="isDead(currentCharacter)">
                                    <div class="attribute-label">{{ language === 'zh' ? 'æ­»å› :' : 'Cause of Death:' }}</div>
                                    <div class="attribute-value cause-red">{{ getLocalizedProp(currentCharacter, 'causeOfDeath') }}</div>
                                </div>
                                
                                <div class="character-bio">
                                    {{ getLocalizedProp(currentCharacter, 'bio') }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div v-else class="character-card" key="no-result">
                        <div class="character-content" style="justify-content: center; align-items: center;">
                            <div style="text-align: center;">
                                <div style="font-size: 5rem;">ğŸ•³ï¸</div>
                                <h2 style="font-size: 2.5rem; margin-top: 20px;">{{ language === 'zh' ? 'æŸ¥æ— æ­¤è§’è‰²' : 'No characters found' }}</h2>
                                <p>{{ language === 'zh' ? 'ç”Ÿæ­»ç°¿ä¸­æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è§’è‰²' : 'No matching characters in the chronicle' }}</p>
                            </div>
                        </div>
                    </div>
                </transition>
                
                <div class="book-footer">
                    <div class="page-indicator">
                        {{ language === 'zh' ? 'ç¬¬' : 'Page' }} {{ currentPage + 1 }} {{ language === 'zh' ? 'é¡µ' : '' }} / {{ language === 'zh' ? 'å…±' : 'of' }} {{ filteredCharacters.length }} {{ language === 'zh' ? 'é¡µ' : '' }}
                    </div>
                    <div class="page-controls">
                        <button @click="prevPage" :disabled="currentPage === 0">{{ language === 'zh' ? 'ä¸Šä¸€é¡µ' : 'Previous' }}</button>
                        <button @click="nextPage" :disabled="currentPage === filteredCharacters.length - 1">{{ language === 'zh' ? 'ä¸‹ä¸€é¡µ' : 'Next' }}</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

<!--    &lt;!&ndash; å¼•å…¥axios &ndash;&gt;-->
<!--    <script type="module">-->
<!--        import {createApp} from '../js/vue.esm-browser.js'-->
<!--        createApp({-->
<!--            data(){-->
<!--                return {-->
<!--                    characters: []-->
<!--                }-->
<!--            },-->
<!--            methods: {-->
<!--                async search(){-->
<!--                    const result = await axios.get('../characters');-->
<!--                    this.characters = result;-->
<!--                }-->
<!--            },-->
<!--            mounted() {-->
<!--                this.search();-->
<!--            }-->
<!--        }).mount('#app')-->
<!--    </script>-->

    <script>
        const { createApp, ref, computed, reactive, watch, onMounted, onUnmounted} = Vue;

        createApp({
            setup() {
                // çŠ¶æ€ç®¡ç†
                const currentYear = ref(0);
                const timerRunning = ref(false);
                const timer = ref(null);
                const customYear = ref('');
                const language = ref('zh');
                const musicPlaying = ref(false);
                const audioPlayer = ref(null);
                const searchQuery = ref('');
                const currentPage = ref(0);
                const statusChanges = ref([]);
                const statusKey = ref(0);
                const characters = ref([]);
                const fetchCharacters = async () => {
                    try{
                        const reponse = await axios.get('../characters');
                        characters.value = reponse.data;
                    } catch(error){
                        console.error('è·å–è§’è‰²æ•°æ®å¤±è´¥:',error);
                    }
                };

                onMounted(()=>{
                    fetchCharacters();
                    audioPlayer.value = new Audio('../music/yungongxunyin.mp3');
                    audioPlayer.value.loop = true;
                    audioPlayer.value.preload = true;
                })


                // // è§’è‰²æ•°æ®ï¼ˆä¸­è‹±æ–‡ï¼‰
                // const characters = reactive([
                //     {
                //         id: 1,
                //         name: { zh: "å­™æ‚Ÿç©º", en: "Sun Wukong" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //         bio: {
                //             zh: "é½å¤©å¤§åœ£ï¼Œè¥¿æ¸¸è®°ä¸­ä¸»è§’ï¼Œå”åƒ§çš„å¤§å¾’å¼Ÿã€‚åŸä¸ºçŸ³çŒ´ï¼Œæ‹œè©æç¥–å¸ˆä¸ºå¸ˆå­¦å¾—æ³•æœ¯ï¼Œèƒ½ä¸ƒåäºŒå˜ã€‚æ›¾å¤§é—¹å¤©å®«ï¼Œåè¢«å¦‚æ¥ä½›ç¥–å‹åœ¨äº”è¡Œå±±ä¸‹äº”ç™¾å¹´ã€‚",
                //             en: "The Monkey King, protagonist of Journey to the West, is the eldest disciple of Tang Sanzang. Originally a stone monkey, he learned magic from Patriarch Subodhi, gaining 72 transformations. He once wreaked havoc in Heaven and was imprisoned under Five Elements Mountain by Buddha for five centuries."
                //         },
                //         causeOfDeath: {
                //             zh: "çœŸå‡ç¾çŒ´ç‹ä¸­è¢«å…­è€³çŒ•çŒ´å–ä»£ï¼Œç¥ç§˜æ¶ˆå¤±",
                //             en: "Replaced by the Six-Eared Macaque in 'The Real and Fake Monkey King', mysteriously vanished"
                //         },
                //         birthYear: 50,
                //         deathYear: 1650
                //     },
                //     {
                //         id: 2,
                //         name: { zh: "ç™½éª¨ç²¾", en: "White Bone Demon" },
                //         affiliation: { zh: "å¦–æ€ª", en: "Demon" },
                //         bio: {
                //             zh: "ç™½è™å²­ä¸Šçš„ç™½éª¨å°¸é­”ï¼Œä¸‰ç•ªä¸¤æ¬¡å˜åŒ–æˆå¥³å­ã€è€å¦ªã€è€ç¿æ¬ºéª—å”åƒ§å¸ˆå¾’ï¼Œæ˜¯å”¯ä¸€ä¸€ä¸ªä¸éœ€è¦æ³•å®å°±èƒ½å˜åŒ–ä¸‰æ¬¡çš„å¦–æ€ªã€‚",
                //             en: "A demon of white bones at White Tiger Mountain. She transformed into a woman, old woman, and old man to deceive Tang Sanzang and his disciples multiple times. She is the only demon capable of transforming three times without any magical treasures."
                //         },
                //         causeOfDeath: {
                //             zh: "è¢«å­™æ‚Ÿç©ºä¸‰æ‰“ç™½éª¨ç²¾å‡»æ€",
                //             en: "Beaten to death by Sun Wukong in 'Three Strikes Against White Bone Demon'"
                //         },
                //         birthYear: 630,
                //         deathYear: 640
                //     },
                //     {
                //         id: 3,
                //         name: { zh: "äºŒéƒç¥", en: "Erlang Shen" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //         bio: {
                //             zh: "åˆç§°äºŒéƒæ˜¾åœ£çœŸå›ï¼Œç‰å¸çš„å¤–ç”¥ï¼Œä¸­å›½ç¥è¯ä¸­çš„æˆ˜ç¥ã€‚æ›¾å¥‰æ—¨å‚ä¸å›´å‰¿èŠ±æœå±±æ‰æ‹¿å­™æ‚Ÿç©ºï¼Œæ³•åŠ›é«˜å¼ºã€‚",
                //             en: "Also known as True Lord Erlang, nephew of the Jade Emperor, and war god in Chinese mythology. Sent to capture Sun Wukong at Flower Fruit Mountain. Possesses formidable divine powers."
                //         },
                //         causeOfDeath: {
                //             zh: "è‡³ä»Šå­˜æ´»äºç¥è¯ä¼ è¯´ä¸­",
                //             en: "Alive in mythological legends to this day"
                //         },
                //         birthYear: 60,
                //         deathYear: null
                //     },
                //     {
                //         id: 4,
                //         name: { zh: "å”åƒ§", en: "Tang Sanzang" },
                //         affiliation: { zh: "äººç±»", en: "Human" },
                //         bio: {
                //             zh: "åŸå‹ä¸ºå”æœé«˜åƒ§ç„å¥˜æ³•å¸ˆï¼Œå¥‰å”å¤ªå®—ä¹‹å‘½å‰å¾€è¥¿å¤©å–ç»ã€‚æ€§æ ¼æ…ˆæ‚²ä¸ºæ€€ä½†è¿‡äºä»æ…ˆï¼Œå¸¸è¢«å¦–æ€ªæ‰€æ¬ºéª—ã€‚åœ¨å¾’å¼Ÿä»¬ä¿æŠ¤ä¸‹å®Œæˆå–ç»å¤§ä¸šã€‚",
                //             en: "Based on the eminent monk Xuanzang of Tang Dynasty. He journeyed to India to retrieve Buddhist scriptures under Emperor Taizong's order. Extremely compassionate but overly merciful, he was often deceived by demons. With disciples' protection, he completed the pilgrimage and attained Buddhahood."
                //         },
                //         causeOfDeath: {
                //             zh: "æˆä½›åè¶…è„±ç”Ÿæ­»è½®å›",
                //             en: "Transcended life-death cycle upon achieving Buddhahood"
                //         },
                //         birthYear: 602,
                //         deathYear: 664
                //     },
                //     {
                //         id: 5,
                //         name: { zh: "çŒªå…«æˆ’", en: "Zhu Bajie" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //         bio: {
                //             zh: "åŸä¸ºå¤©è“¬å…ƒå¸…ï¼Œå› è°ƒæˆå«¦å¨¥è¢«è´¬ä¸‹å‡¡ã€‚è¢«è§‚éŸ³è©è¨ç‚¹åŒ–åæˆä¸ºå”åƒ§äºŒå¾’å¼Ÿï¼Œæ­¦å™¨ä¹é½¿é’‰è€™ã€‚å–ç»åå°ä¸ºå‡€å›ä½¿è€…ï¼Œè™½å¥½åƒæ‡’åšå´å¿ å‹‡å¯çˆ±ã€‚",
                //             en: "Former Marshal of Heavenly Canopy, banished to earth. Became Tang Sanzang's second disciple after enlightenment by Guanyin. Despite laziness and gluttony, loyal and brave. Sealed as Altar Cleanser after pilgrimage."
                //         },
                //         causeOfDeath: {
                //             zh: "æˆä½›åè¶…è„±ç”Ÿæ­»è½®å›",
                //             en: "Transcended life-death cycle upon achieving Buddhahood"
                //         },
                //         birthYear: 150,
                //         deathYear: null
                //     },
                //     {
                //         id: 6,
                //         name: { zh: "å¦‚æ¥ä½›ç¥–", en: "Buddha" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //         bio: {
                //             zh: "ä½›æ•™æœ€é«˜é¢†è¢–ï¼Œäº”æŒ‡å±±é•‡å‹å­™æ‚Ÿç©ºã€‚ä½›æ³•æ— è¾¹æ™ºæ…§å¹¿å¤§ï¼Œåˆ¶å®šå–ç»è®¡åˆ’æ•‘æ¸¡ä¼—ç”Ÿï¼ŒçœŸèº«å±…äºè¥¿æ–¹æä¹ä¸–ç•Œã€‚",
                //             en: "Supreme leader of Buddhism who subdued Sun Wukong under Five Finger Mountain. Designed pilgrimage to save humanity. Resides in Western Paradise with boundless wisdom."
                //         },
                //         causeOfDeath: {
                //             zh: "çœŸä½›ä¸ç”Ÿä¸ç­",
                //             en: "Cosmic Buddha beyond life-death cycles"
                //         },
                //         birthYear: 0,
                //         deathYear: null
                //     },
                //     {
                //         id: 7,
                //         name: { zh: "ç‰›é­”ç‹", en: "Bull Demon King" },
                //         affiliation: { zh: "å¦–æ€ª", en: "Demon" },
                //         bio: {
                //             zh: "å­™æ‚Ÿç©ºç»“ä¹‰å…„å¼Ÿï¼Œç«ç„°å±±ä¸»äººã€‚èº«æ€€ä¸ƒåäºŒå˜ç¥é€šï¼Œæ‰‹æŒæ··é“æ£ã€‚å› çº¢å­©å„¿äº‹ä»¶ä¸æ‚Ÿç©ºåç›®ï¼Œåè¢«å¤©åº­é™æœçšˆä¾ä½›é—¨ã€‚",
                //             en: "Sworn brother of Sun Wukong, ruler of Flame Mountain. Master of transformations, wields iron staff. Turned against Wukong after Red Boy incident, later subdued by Heaven."
                //         },
                //         causeOfDeath: {
                //             zh: "è¢«ä½›æ³•æ„ŸåŒ–åéšå±…ä¿®ç‚¼",
                //             en: "Retreated to seclusion after Buddhist enlightenment"
                //         },
                //         birthYear: 200,
                //         deathYear: 1650
                //     },
                //     {
                //         id: 8,
                //         name: { zh: "å·¨çµç¥", en: "Giant Spirit God" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //         bio: {
                //             zh: "å¤©åº­å…ˆé”‹ç¥å°†ï¼Œæ‰‹æŒå®£èŠ±æ–§ã€‚èŠ±æœå±±è®¨ä¼å­™æ‚Ÿç©ºæ—¶é¦–æˆ˜è¢«å‡»è´¥ï¼Œéªå‹‡å–„æˆ˜ä½†æŠ€ä¸å¦‚çŒ´ã€‚åä»»å¤©é—¨é•‡å®ˆç¥å°†ã€‚",
                //             en: "Heaven's vanguard commander with floral axe. First challenger defeated by Sun Wukong at Flower Fruit Mountain. Known for valor despite lower combat skills, later guarded heavenly gates."
                //         },
                //         causeOfDeath: {
                //             zh: "ç¥è¯æ—¶ä»£åéšå…¥å¤©ç•Œ",
                //             en: "Withdrew to celestial realm after mythical era"
                //         },
                //         birthYear: 300,
                //         deathYear: 1400
                //     },
                //     {
                //         id: 9,
                //         name: { zh: "å°ç™½é¾™", en: "White Dragon Horse" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //
                //         bio: {
                //             zh: "è¥¿æµ·é¾™ç‹ä¸‰å¤ªå­ï¼Œå› çºµç«çƒ§æ®¿è¢«è´¬ã€‚é¹°æ„æ¶§åŒ–ç™½é©¬é©®å”åƒ§å–ç»ï¼Œåå°å…«éƒ¨å¤©é¾™å¹¿åŠ›è©è¨ã€‚æ²‰é™åšæ¯…ï¼Œå…³é”®æ—¶åŒ–é¾™å‡ºæˆ˜ã€‚",
                //             en: "Third Dragon Prince of West Sea, punished for arson. Carried Tang Sanzang as white horse after redemption. Sealed as Dragon Power Bodhisattva. Known for resilience and timely interventions."
                //         },
                //         causeOfDeath: {
                //             zh: "æˆä½›ååŒ–èº«å…«éƒ¨å¤©é¾™",
                //             en: "Transformed into Eightfold Dragon upon Buddhahood"
                //         },
                //         birthYear: 400,
                //         deathYear: null
                //     },
                //     {
                //         id: 10,
                //         name: { zh: "èµ¤è„šå¤§ä»™", en: "Barefoot Immortal" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //         bio: {
                //             zh: "é€é¥è‡ªåœ¨çš„äº‘æ¸¸ç¥ä»™ï¼Œå¸¸æèŠ±ç¯®èµ¤è¶³è¡Œäºä¸‰ç•Œã€‚è­¦ç¤ºèŸ æ¡ƒä¼šå˜æ•…æ•‘ä¼—ä»™ï¼Œç‚¹åŒ–å­™æ‚Ÿç©ºæ—¶æ˜¾éœ²å¤§æ™ºæ…§ã€‚",
                //             en: "Carefree roaming immortal who walks barefoot through realms. Warned deities of Peach Banquet disruption. Showed profound wisdom when enlightening Sun Wukong."
                //         },
                //         causeOfDeath: {
                //             zh: "ä»™è¸ªé£˜æ¸ºåŒ–èº«å¤©åœ°çµæ°”",
                //             en: "Merged with cosmic energies as ethereal being"
                //         },
                //         birthYear: 1000,
                //         deathYear: null
                //     },
                //     {
                //         id: 11,
                //         name: { zh: "ä¸œæµ·é¾™ç‹", en: "Dragon King of East Sea" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //         bio: {
                //             zh: "å››æµ·é¾™å®«ä¹‹é¦–ï¼Œæ‰§æŒä¸œæµ·é£é›¨ã€‚è¢«å­™æ‚Ÿç©ºå¼ºå–å®šæµ·ç¥é’ˆï¼Œå¸¸åŠ©å”åƒ§å¸ˆå¾’è¿‡æµ·é™å¦–ã€‚æ³•å™¨é¾™ç å¯å‘¼é£å”¤é›¨ã€‚",
                //             en: "Ruler of Four Seas, controls eastern waters. Provided Golden Cudgel to Sun Wukong. Often helped pilgrims cross seas with dragon pearls commanding storms."
                //         },
                //         causeOfDeath: {
                //             zh: "é¾™å…ƒå½’æµ·æ°¸é•‡æ°´è„‰",
                //             en: "Dragon essence returned to eternally guard seas"
                //         },
                //         birthYear: 250,
                //         deathYear: 1800
                //     },
                //     {
                //         id: 12,
                //         name: { zh: "æ²™åƒ§", en: "Sha Wujing" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //         bio: {
                //             zh: "åŸä¸ºå·å¸˜å¤§å°†ï¼Œæ‰“ç ´ç‰ç’ƒç›è¢«è´¬æµæ²™æ²³ã€‚ä»»åŠ³ä»»æ€¨æŒ‘è¡Œæçš„å”åƒ§ä¸‰å¾’å¼Ÿï¼Œé™å¦–å®æ–å¨åŠ›éå‡¡ã€‚å–ç»åå°é‡‘èº«ç½—æ±‰ã€‚",
                //             en: "Former Curtain-Raising General banished to Flowing Sand River. Tang Sanzang's third disciple carrying luggage. Used powerful demon-subduing staff, later became Golden Arhat."
                //         },
                //         causeOfDeath: {
                //             zh: "è¯å¾—ç½—æ±‰æœä½",
                //             en: "Attained Arhat enlightenment"
                //         },
                //         birthYear: 300,
                //         deathYear: null
                //     },
                //     {
                //         id: 13,
                //         name: { zh: "è§‚éŸ³è©è¨", en: "Guanyin Bodhisattva" },
                //         affiliation: { zh: "ç¥ä»™", en: "Immortal" },
                //         bio: {
                //             zh: "å¤§æ…ˆå¤§æ‚²æ•‘è‹¦æ•‘éš¾ï¼Œå–ç»è®¡åˆ’åˆ¶å®šè€…ã€‚å¤šæ¬¡åŒ–èº«è§£å”åƒ§åŠ«éš¾ï¼Œèµå­™æ‚Ÿç©ºä¸‰æ ¹æ•‘å‘½æ¯«æ¯›ã€‚é“åœºåœ¨å—æµ·æ™®é™€å±±ã€‚",
                //             en: "Embodiment of mercy who designed pilgrimage. Frequently rescued Tang Sanzang, gave Wukong life-saving hairs. Resides at Mount Putuo's Buddhist sanctuary."
                //         },
                //         causeOfDeath: {
                //             zh: "è©è¨ä¹˜æ„¿æ°¸ä¸æ¶…æ§ƒ",
                //             en: "Bodhisattva vows prevent final nirvana"
                //         },
                //         birthYear: 100,
                //         deathYear: null
                //     },
                //     {
                //         id: 14,
                //         name: { zh: "å”å¤ªå®—", en: "Emperor Taizong" },
                //         affiliation: { zh: "äººç±»", en: "Human" },
                //         bio: {
                //             zh: "å”æœå¼€æ˜å›ä¸»ï¼Œå§”æ‰˜å”åƒ§è¥¿å¤©å–ç»ã€‚å› é­å¾æ¢¦æ–©æ³¾æ²³é¾™ç‹ç»å†åœ°åºœè¿˜é˜³ï¼Œå¼€åˆ›è´è§‚ç››ä¸–æ”¯æŒè¯‘ä¼ ä½›ç»ã€‚",
                //             en: "Enlightened Tang emperor who commissioned scripture quest. Visited afterlife after Jing River Dragon incident, revived to support Buddhist translation in Zhenguan golden age."
                //         },
                //         causeOfDeath: {
                //             zh: "é˜³å¯¿å·²å°½å®‰è¯¦é©¾å´©",
                //             en: "Peacefully passed when lifespan ended"
                //         },
                //         birthYear: 1598,
                //         deathYear: 1649
                //     },
                //     {
                //         id: 15,
                //         name: { zh: "é“æ‰‡å…¬ä¸»", en: "Princess Iron Fan" },
                //         affiliation: { zh: "å¦–æ€ª", en: "Demon" },
                //         bio: {
                //             zh: "ç‰›é­”ç‹ä¹‹å¦»ï¼Œçº¢å­©å„¿ä¹‹æ¯ï¼ŒæŒæœ‰å¤ªé˜³ç²¾å¶ç‚¼åˆ¶çš„èŠ­è•‰æ‰‡ã€‚å› çº¢å­©å„¿è¢«è§‚éŸ³æ”¶æœæ€¨æ¨å­™æ‚Ÿç©ºï¼Œä¸‰å€ŸèŠ­è•‰æ‰‡æ—¶è®¾è®¡å‘¨æ—‹ï¼Œæœ€ç»ˆä¸ºæ•‘ä¸ˆå¤«äº¤å‡ºå®æ‰‡ã€‚éšå§“ä¿®è¡Œåå¾—è¯æ­£æœã€‚",
                //             en: "Wife of Bull Demon King and mother of Red Boy. Wields the Banana Leaf Fan capable of extinguishing flames. Resisted Sun Wukong's borrowing attempts due to resentment over her son's capture by Guanyin, ultimately surrendering the fan to save her husband."
                //         },
                //         causeOfDeath: {
                //             zh: "ä¿®å¾—æ­£æœè¶…è„±è½®å›",
                //             en: "Achieved enlightenment beyond life-death cycle"
                //         },
                //         birthYear: 200,
                //         deathYear: null  // åœ°ä»™ä¿®ä¸ºä¸æ­»ä¸ç­
                //     },
                //     {
                //         id: 16,
                //         name: { zh: "èœ˜è››ç²¾", en: "Spider Spirits" },
                //         affiliation: { zh: "å¦–æ€ª", en: "Demon" },
                //         bio: {
                //             zh: "ç›˜ä¸æ´ä¸ƒå¦–ä¹‹é¦–ï¼Œä»¥è››ä¸ä¸ºæ­¦å™¨å–„å¸ƒå¤©ç½—åœ°ç½‘ã€‚åŒ–èº«ç¾äººè¯±æ•å”åƒ§ï¼Œæ¿¯å¢æ³‰æ²æµ´æ—¶é­å­™æ‚Ÿç©ºç›—è¡£æˆè€ï¼Œæœ€ç»ˆè¢«é‡‘ç®æ£’æ‰“ç¢åŸå½¢ã€‚",
                //             en: "Seven spider demons residing in Cobweb Cave. Skilled in weaving indestructible silk traps. Captured Tang Sanzang by disguising as bathing maidens, but were defeated when Sun Wukong destroyed their silk webs with golden cudgel."
                //         },
                //         causeOfDeath: {
                //             zh: "è¢«å­™æ‚Ÿç©ºç ´é™¤å¦–èº«",
                //             en: "Physical form destroyed by Sun Wukong"
                //         },
                //         birthYear: 620,
                //         deathYear: 640  // å–ç»é€”ä¸­è¢«ç­
                //     },
                //     {
                //         id: 17,
                //         name: { zh: "ç‰å…”ç²¾", en: "Jade Rabbit Spirit" },
                //         affiliation: { zh: "å¦–æ€ª", en: "Demon" },
                //         bio: {
                //             zh: "å¹¿å¯’å®«æ£è¯ç‰å…”ä¸‹å‡¡ï¼Œä¸ºæŠ¥ç´ å¨¥ä»™å­ä¸€æŒä¹‹ä»‡åŒ–èº«å¤©ç«ºå…¬ä¸»ã€‚æŠ›ç»£çƒå¼ºæ‹›å”åƒ§ä¸ºé©¸é©¬ï¼Œè¢«è¯†ç ´åç°åŸå½¢äº¤æˆ˜ï¼Œç»ˆè¢«å¤ªé˜´æ˜Ÿå›æ”¶å›æœˆå®«ã€‚",
                //             en: "Moon Palace's jade rabbit who descended to earth seeking revenge. Impersonated Indian princess to force-marry Tang Sanzang. Revealed by Sun Wukong and subdued by Moon Goddess's intervention."
                //         },
                //         causeOfDeath: {
                //             zh: "å›å½’ä»™ç±æ°¸ç”Ÿä¸ç­",
                //             en: "Returned to immortal status eternally"
                //         },
                //         birthYear: 500,
                //         deathYear: null  // ä»™ç±çµå…½æ— ç”Ÿæ­»
                //     },
                // ]);
                //
                // è¿‡æ»¤åçš„è§’è‰²åˆ—è¡¨
                // const filteredCharacters = computed(() => {
                //     if (!searchQuery.value) return characters;
                //
                //     return characters.filter(char => {
                //         const nameZh = char.name.zh.toLowerCase();
                //         const nameEn = char.name.en.toLowerCase();
                //         const query = searchQuery.value.toLowerCase();
                //
                //         return nameZh.includes(query) || nameEn.includes(query);
                //     });
                // });

                const filteredCharacters = computed(() => {
                    if ( !searchQuery.value) return characters.value;

                    return characters.value.filter(char => {
                        const nameZh = char.name.zh.toLowerCase();
                        const nameEn = char.name.en.toLowerCase();
                        const query = searchQuery.value.toLowerCase();

                        return nameZh.includes(query) || nameEn.includes(query);
                    });
                });
                
                // å½“å‰è§’è‰²
                const currentCharacter = computed(() => {
                    if (filteredCharacters.value.length === 0) {
                        return {};
                    }
                    return filteredCharacters.value[currentPage.value];
                });
                
                // è·å–æœ¬åœ°åŒ–å±æ€§
                const getLocalizedProp = (char, prop) => {
                    if (!char || !char[prop]) return '';
                    return char[prop][language.value] || char[prop].zh;
                };
                
                // æ£€æŸ¥è§’è‰²æ˜¯å¦æ­»äº¡
                const isDead = (char) => {
                    if (!char.deathYear) return false;
                    return currentYear.value >= char.deathYear;
                };
                
                // è·å–è§’è‰²çŠ¶æ€æ–‡æœ¬
                const getStatusText = (char) => {
                    if ( !char || !char.birthYear) return '';

                    if (currentYear.value < char.birthYear) {
                        return language.value === 'zh' ? 'æœªå‡ºç”Ÿ' : 'Not Born';
                    } else if (isDead(char)) {
                        return language.value === 'zh' ? 'æ­»äº¡' : 'Deceased';
                    }
                    return language.value === 'zh' ? 'å­˜æ´»' : 'Alive';
                };
                
                // è·å–è§’è‰²çŠ¶æ€ç±»
                const getStatusClass = (char) => {
                    if (currentYear.value < char.birthYear) {
                        return '';
                    } else if (isDead(char)) {
                        return 'status-dead';
                    }
                    return 'status-alive';
                };
                
                // è·å–è§’è‰²çš„emojiå›¾æ ‡
                const getEmoji = (nameObj) => {
                    const name = nameObj.zh;
                    if (name === "å­™æ‚Ÿç©º") return "../image/å­™æ‚Ÿç©º.png";
                    if (name === "ç™½éª¨ç²¾") return "../image/ç™½éª¨ç²¾.png";
                    if (name === "äºŒéƒç¥") return "../image/äºŒéƒç¥.png";
                    if (name === "å”åƒ§") return "../image/å”åƒ§.png";
                    if (name === "çŒªå…«æˆ’") return "../image/çŒªå…«æˆ’.png";
                    if (name === "å¦‚æ¥ä½›ç¥–") return "../image/å¦‚æ¥ä½›ç¥–.png";
                    if (name === "ç‰›é­”ç‹") return "../image/ç‰›é­”ç‹.png";
                    if (name === "å·¨çµç¥") return "../image/å·¨çµç¥.png";
                    if (name === "å°ç™½é¾™") return "../image/å°ç™½é¾™.png";
                    if (name === "èµ¤è„šå¤§ä»™") return "../image/èµ¤è„šå¤§ä»™.png";
                    if (name === "ä¸œæµ·é¾™ç‹") return "../image/ä¸œæµ·é¾™ç‹.png";
                    if (name === "æ²™åƒ§") return "../image/æ²™åƒ§.png";
                    if (name === "è§‚éŸ³è©è¨") return "../image/è§‚éŸ³è©è¨.png";
                    if (name === "å”å¤ªå®—") return "../image/å”å¤ªå®—.png";
                    if (name === "ç‰å…”ç²¾") return "../image/ç‰å…”ç²¾.png";
                    if (name === "é“æ‰‡å…¬ä¸»") return "../image/é“æ‰‡å…¬ä¸».png";
                    if (name === "èœ˜è››ç²¾") return "../image/èœ˜è››ç²¾.png";
                    return "â“";
                };
                
                // åˆ‡æ¢æ—¶é—´æ§åˆ¶å™¨è¿è¡ŒçŠ¶æ€
                const toggleTimer = () => {
                    if (timerRunning.value) {
                        stopTimer();
                    } else {
                        startTimer();
                    }
                };
                
                // å¯åŠ¨è®¡æ—¶å™¨
                const startTimer = () => {
                    timerRunning.value = true;
                    timer.value = setInterval(() => {
                        if (currentYear.value < 2027) {
                            const lastYear = currentYear.value;
                            currentYear.value++;
                            
                            // æ£€æŸ¥çŠ¶æ€å˜åŒ–
                            checkStatusChanges(lastYear);
                        } else {
                            stopTimer();
                        }
                    }, 300);
                };
                
                // åœæ­¢è®¡æ—¶å™¨
                const stopTimer = () => {
                    timerRunning.value = false;
                    clearInterval(timer.value);
                };
                
                // é‡ç½®æ—¶é—´
                const resetTimer = () => {
                    stopTimer();
                    currentYear.value = 0;
                    statusChanges.value = [];
                    startTimer();
                };
                
                // è·³è½¬åˆ°ç‰¹å®šå¹´ä»½
                const jumpToYear = () => {
                    const year = parseInt(customYear.value);
                    if (!isNaN(year) && year >= 0 && year <= 2027) {
                        const lastYear = currentYear.value;
                        currentYear.value = year;
                        checkStatusChanges(lastYear);
                    }
                    customYear.value = '';
                };
                
                // æ£€æŸ¥çŠ¶æ€å˜åŒ–
                const checkStatusChanges = (lastYear) => {
                    const changes = [];
                    
                    characters.value.forEach(char => {
                        if (lastYear < char.birthYear && currentYear.value >= char.birthYear) {
                            changes.push(
                                language.value === 'zh' 
                                    ? `${getLocalizedProp(char, 'name')} è¯ç”Ÿäº ${char.birthYear}å¹´`
                                    : `${getLocalizedProp(char, 'name')} was born in ${char.birthYear}`
                            );
                        }
                        
                        if (char.deathYear !== null && 
                            lastYear < char.deathYear && 
                            currentYear.value >= char.deathYear && 
                            currentYear.value > char.birthYear) {
                            changes.push(
                                language.value === 'zh' 
                                    ? `${getLocalizedProp(char, 'name')} æ®’è½äº ${char.deathYear}å¹´`
                                    : `${getLocalizedProp(char, 'name')} died in ${char.deathYear}`
                            );
                        }
                    });
                    
                    if (changes.length > 0) {
                        statusChanges.value = [...statusChanges.value, ...changes].sort((a, b) => {
                            const getYear = str => parseInt(str.match(/(è¯ç”Ÿäº|æ®’è½äº|born in|died in)\s*(\d+)/)[2]);
                            return getYear(a) - getYear(b);
                        });
                        statusKey.value++;
                    }
                };
                
                // åˆ‡æ¢è¯­è¨€
                const toggleLanguage = () => {
                    language.value = language.value === 'zh' ? 'en' : 'zh';
                    document.documentElement.lang = language.value === 'zh' ? 'zh-CN' : 'en';
                    document.body.classList.toggle('chinese-font', language.value === 'zh');
                };
                
                // æ§åˆ¶èƒŒæ™¯éŸ³ä¹
                const toggleMusic = () => {
                    if ( !audioPlayer.value) return;

                    if (musicPlaying.value) {
                        audioPlayer.value.pause();
                    } else {
                        audioPlayer.value.play().catch(e => {
                            console.error("Audio play error:", e);
                            if ( e.name = 'NotAllowedError'){
                                alert('è¯·ç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®åé‡è¯•æ’­æ”¾æŒ‰é’®');
                            }
                        });
                    }
                    musicPlaying.value = !musicPlaying.value;
                };
                
                // ç¿»é¡µæ§åˆ¶
                const nextPage = () => {
                    if (currentPage.value < filteredCharacters.value.length - 1) {
                        currentPage.value++;
                    }
                };
                
                const prevPage = () => {
                    if (currentPage.value > 0) {
                        currentPage.value--;
                    }
                };
                
                // å¤„ç†æœç´¢æ”¹å˜æ—¶çš„é¡µç é‡ç½®
                watch(filteredCharacters, (newVal) => {
                    if (newVal.length > 0 && currentPage.value >= newVal.length) {
                        currentPage.value = 0;
                    }
                });
                
                // å¼€å§‹æ—¶é—´æµåŠ¨
                startTimer();
                
                return {
                    currentYear,
                    timerRunning,
                    customYear,
                    language,
                    musicPlaying,
                    audioPlayer,
                    searchQuery,
                    currentPage,
                    statusChanges,
                    statusKey,
                    characters,
                    filteredCharacters,
                    currentCharacter,
                    getLocalizedProp,
                    isDead,
                    getStatusText,
                    getStatusClass,
                    getEmoji,
                    toggleTimer,
                    resetTimer,
                    jumpToYear,
                    toggleLanguage,
                    toggleMusic,
                    nextPage,
                    prevPage
                };
            }
        }).mount('#app');
    </script>
</body>
</html>